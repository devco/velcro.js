!function(t){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?t(module.exports||exports):"function"==typeof define&&define.amd?define(["exports"],t):t(window.vc={})}(function(t){if(function(){"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(t){var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},o=function(){return n.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o})}(),function(){t.utils={each:function(t,e){if(t=t||[],"string"==typeof t&&(t=[t]),"number"==typeof t.length){for(var n=0;t.length>n;n++)if(e(n,t[n])===!1)return}else for(var i in t)if(e(i,t[i])===!1)return},fnCompare:function(t,e){return t?("object"==typeof t&&t.constructor&&(t=t.constructor),"function"==typeof t&&(t=""+t),t===e):!1},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isInstance:function(t){return t&&"function"==typeof t.constructor},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isValue:function(e){return"function"==typeof e&&""+e==""+t.value()},merge:function(){for(var e={},n=0;arguments.length>n;n++){var i=arguments[n];if(t.utils.isObject(i))for(var o in i){var s=i[o];e[o]=void 0!==e[o]?t.utils.isInstance(s)?s:t.utils.isObject(e[o])&&t.utils.isObject(s)?t.utils.merge(e[o],s):s:s}}return e},parseBinding:function(t,e){var n="";for(var i in e)n+="var "+i+"=__context['"+i+"'];";n+="return {"+t+"};";try{return Function("__context",n)(e)}catch(o){throw'Error parsing binding "'+t+'" with message: "'+o+'"'}},parseJson:function(t){if("undeinfed"==typeof JSON||"function"!=typeof JSON.parse)throw'Unable to parse JSON string "'+t+'" because no JSON parser is available via JSON.parse().';try{return JSON.parse(t)}catch(e){throw'Error parsing JSON string "'+t+'" with message "'+e+'".'}},extract:function(e){var n={};return t.utils.each(e,function(e,i){n[e]=t.utils.isValue(i)?i():i}),n},throwForElement:function(e,n){throw n+"\n"+t.dom(e).html()}}}(),function(){var e=!1;t.Class=function(){},t.Class.extend=function(t){function n(){e||"function"!=typeof this.init||this.init.apply(this,arguments)}var i=arguments.callee;e=!0,n.prototype=new this,e=!1,n.extend=i;for(var o in t)n.prototype[o]=t[o];return n.prototype.constructor=n}}(),function(){function e(){var t=this;return setTimeout(function(){switch(t._state){case"fulfilled":for(var e=0;t._fulfilledHandlers.length>e;e++)t._fulfilledHandlers[e](t._value);break;case"rejected":for(var n=0;t._rejectedHandlers.length>n;n++)t._rejectedHandlers[n](t._reason)}"pending"!==t._state&&(t._fulfilledHandlers=[],t._rejectedHandlers=[])},1),this}t.Promise=t.Class.extend({_executed:!1,_value:null,_reason:null,_state:"pending",init:function(){this._fulfilledHandlers=[],this._rejectedHandlers=[]},then:function(t,n){return"function"==typeof t&&this._fulfilledHandlers.push(t),"function"==typeof n&&this._rejectedHandlers.push(n),e.call(this)},fulfill:function(t){var n=this;if(this._executed)throw"A promise may only be fulfilled once.";return this._executed=!0,setTimeout(function(){try{n._value=t(),n._state="fulfilled"}catch(i){n._reason=i,n._state="rejected"}e.call(n)},1),this}})}(),function(){function e(t){var e=t.match(/<!--\s*(.*?)\s*-->/);if(e)return document.createComment(e[0]);var i=t.match(/^<([^\s>]+)/)[1],o=document.createElement(n(i));o.innerHTML=t;var s=o.childNodes[0];return o.removeChild(s),s}function n(t){var e={colgroup:"table",col:"colgroup",caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"thead",td:"tr"};return t=t.toLowerCase(),e[t]!==void 0?e[t]:"div"}t.Dom=t.Class.extend({element:null,init:function(n){n instanceof t.Dom?n=n.raw():"string"==typeof n&&(n=e(n)),this.element=n},raw:function(){return this.element},css:function(t){if(0===arguments.length){for(var e=this.attr("class").split(/\s+/),n={},o=0;e.length>o;o++)n[e[o]]=!0;return n}var s=[];if("number"==typeof t.length)for(var r=0;t.length>r;r++)s.push(t[i]);else for(var u in t)t[u]&&-1===s.indexOf(u)&&s.push(u);return this.attr("class",s.join(" ").replace(/^\s\s*/,"").replace(/\s\s*$/,""))},attr:function(t,e){return 1===arguments.length?this.element.getAttribute?this.element.getAttribute(t)||"":this.element[t]===void 0?"":this.element[t]||"":e?(this.element.setAttribute?this.element.setAttribute(t,e):this.element[t]=e,this):(this.element.removeAttribute?this.element.removeAttribute(t):this.element[t]=null,this)},removeAttributes:function(){if(this.element.attributes)for(var t=0;this.element.attributes.length>t;t++)this.attr(this.element.attributes[t].nodeName,"");return this},on:function(t,e){function n(t){t.preventDefault||(t.preventDefault=function(){return t.returnValue=!1,t}),t.stopPropagation||(t.stopPropagation=function(){return t.cancelBubble=!0,t}),e(t)===!1&&t.preventDefault()}var i=this;return this.element.addEventListener?this.element.addEventListener(t,n,!1):element.attachEvent?this.element.attachEvent("on"+t,function(t){n.call(i.element,t)}):this.element["on"+t]=n,this},off:function(t,e){return this.element.removeEventListener?this.element.removeEventListener(t,e,!1):this.element.detachEvent?this.element.detachEvent(t,e):delete this.element["on"+t],this},once:function(t,e){var n=this;return this.on(t,function(i){n.off(t,e),e(i)}),this},fire:function(t){var e;return document.createEventObject?(e=document.createEventObject(),this.element.fireEvent(t,e)):(e=document.createEvent("Events"),e.initEvent(t,!0,!0),this.element.dispatchEvent(e)),this},destroy:function(){return this.removeAttributes(),this.empty(),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this},empty:function(){if(this.element.childNodes)for(var e=0;this.element.childNodes.length>e;e++)t.dom(this.element.childNodes[e]).destroy();return this.element.innerHTML="",this},html:function(){var t=document.createElement(n(this.element.nodeName));return t.appendChild(this.element.cloneNode(!0)),t.innerHTML},contents:function(t){return arguments.length?(this.element.innerHTML=t,this):this.element.innerHTML},append:function(e){return this.element.appendChild(t.dom(e).raw()),this},text:function(t){return arguments.length?(this.element.innerText=t,this):this.element.innerText},tag:function(){return this.element.nodeName.toLowerCase()},replaceWith:function(e){return e=t.dom(e),this.element.parentNode.insertBefore(e.raw(),this.element),this.destroy(),e}}),t.dom=function(e){return new t.Dom(e)}}(),function(){t.Event=t.Class.extend({init:function(){return this.stack=[],this},bind:function(t){return this.stack.push(t),this},unbind:function(t){if(t){var e=[];for(var n in this.stack)this.stack[n]!==t&&e.push(this.stack[n]);this.stack=e}else this.stack=[];return this},once:function(t){var e=this;return this.bind(function(){t.call(t,arguments),e.unbind(t)})},trigger:function(){return this.triggerArgs(Array.prototype.slice.call(arguments))},triggerArgs:function(t){for(var e in this.stack)if(this.stack[e].apply(this.stack[e],t)===!1)return!1;return this}})}(),function(){function e(){for(var t=!1,e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=0;e.length>n;n++)try{t=e[n]()}catch(i){continue}if(!t)throw"An XMLHttpRequest could not be generated.";return t}t.Http=t.Class.extend({init:function(e){return this.before=new t.Event,this.after=new t.Event,this.success=new t.Event,this.error=new t.Event,this.options=t.utils.merge({async:!0,cache:!1,headers:{},parsers:{"application/json":t.utils.parseJson},prefix:"",suffix:""},e),this},"delete":function(e){return this.request(t.utils.merge(e,{type:"delete"}))},get:function(e){return this.request(t.utils.merge(e,{type:"get"}))},head:function(e){return this.request(t.utils.merge(e,{type:"head"}))},options:function(e){return this.request(t.utils.merge(e,{type:"options"}))},patch:function(e){return this.request(t.utils.merge(e,{type:"patch"}))},post:function(e){return this.request(t.utils.merge(e,{type:"post"}))},put:function(e){return this.request(t.utils.merge(e,{type:"put"}))},request:function(n){var i=this,o=e(),s=new t.Promise;n=t.utils.merge({url:"",type:"GET",data:{},success:function(){},error:function(){},before:function(){},after:function(){}},n);var r=this.options.prefix+n.url+this.options.suffix,u=n.type.toUpperCase(),a=n.data;a instanceof t.Model&&(a=a.raw()),this.options.cache||(a["_"+(new Date).getTime()]="1"),t.utils.isObject(a)&&(a=this.serialize(a)),a&&"GET"===n.type&&(r+="?"+a),o.open(u,r,this.options.async),a&&"GET"!==n.type&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var c in this.options.headers)o.setRequestHeader(c,this.options.headers[c]);return o.onreadystatechange=function(){4===o.readyState&&s.fulfill(function(){if(200!==o.status&&304!==o.status)throw n.error.call(n.error,o),i.error.trigger(o),n.after.call(n.after,o),i.after.trigger(o),o.status+": "+o.statusText;var t=o.responseText,e=o.getAllResponseHeaders(),s=!1;if("string"==typeof e["Content-Type"]&&"function"==typeof i.options.parsers[e["Content-Type"]]?s=i.options.parsers[e["Content-Type"]]:"string"==typeof i.options.headers.Accept&&"function"==typeof i.options.parsers[i.options.headers.Accept]&&(s=i.options.parsers[i.options.headers.Accept]),s)try{t=s(t)}catch(u){throw'Cannot parse response from "'+r+'" with message: '+u}return n.success.call(n.success,t),i.success.trigger(t),n.after.call(n.after,o),i.after.trigger(o),t})},n.before.call(n.before,o),this.before.trigger(o),"GET"===u?o.send():o.send(a),s},serialize:function(t,e){var n=[];for(var i in t){var o=e?e+"["+i+"]":i,s=t[i];n.push("object"==typeof s?this.serialize(s,o):encodeURIComponent(o)+"="+encodeURIComponent(s))}return n.join("&")},defer:function(e,n){var i=this,o=e.split(" "),s="get";return o[1]!==void 0&&(s=o[0].toLowerCase(),e=o[1]),function(o){var r=[],u=e;o=t.utils.merge(n,o);for(var a in o)e.match(":"+a)&&(u=e.replace(":"+a,o[a]),r.push(a));for(var c=0;r.length>c;c++)delete o[r[c]];return i.request({type:s,url:u,data:o})}}})}(),function(){function e(t){window["on"+t]=o}function n(t){document.createEvent?(event=document.createEvent("HTMLEvents"),event.initEvent(t,!0,!0),window.dispatchEvent(event)):window["on"+t](document.createEventObject())}function i(t,e){if(!e){var n=t.replace(/^#/,""),i=document.getElementById(n),o=window.pageXOffset?window.pageXOffset:document.body.scrollLeft,s=window.pageYOffset?window.pageYOffset:document.body.scrollTop,r=document.createElement("div");i&&(i.id=""),r.id=n||"_",r.style.position="absolute",r.style.width=0,r.style.height=0,r.style.left=o+"px",r.style.top=s+"px",r.style.padding=0,r.style.margin=0,document.body.appendChild(r),window.location.hash="#"+r.id,document.body.removeChild(r),i&&(i.id=n)}}function o(){for(var t=0;s.length>t;t++)s[t].dispatch()}var s=[];t.Router=t.Class.extend({init:function(e){return this.options=t.utils.merge({app:{},state:{},view:{}},e),this.enter=new t.Event,this.exit=new t.Event,this.render=new t.Event,this.params={},this.route=!1,this.routes={},this.app=this.options.app instanceof t.App?this.options.app:new t.App(this.options.app),this.state=this.options.state instanceof t.State?this.options.state:new t.State(this.options.state),this.view=this.options.view instanceof t.View?this.options.view:new t.View(this.options.view),this},handler:function(t){t()},renderer:function(e,n){var i=this,o=e.options.controller.apply(e.options.controller,n);o instanceof t.Model||(o=t.Model.extend(o),o=new o),this.view.render(e.options.view,function(t){i.app.bindDescendants(t.options.target,o),i.render.trigger(i,e,n)})},bind:function(){return this.unbind(),s.push(this),"onpopstate"in window&&this.state.enabled&&(!this.state.enabled||window.location.hash)||this.dispatch(),this},unbind:function(){for(var t=0;s.length>t;t++)this===s[t]&&delete s[t];return this},set:function(e,n){return n instanceof t.Route||(n=new t.Route(t.utils.merge({controller:"function"==typeof n?n:function(){},format:e,match:RegExp("^"+e+"$"),view:e||"index"},n))),this.routes[e]=n,this},get:function(t){if(this.has(t))return this.routes[t];throw'Route "'+t+'" does not exist.'},has:function(t){return this.routes[t]!==void 0},remove:function(t){return this.has(t)&&delete this.routes[t],this},dispatch:function(t){function e(t,e){return function(){n.renderer(t,e)}}var n=this;t===void 0&&(t=this.state.get());for(var i in this.routes){var o=this.routes[i],s=o.query(t);"number"==typeof s.length&&(this.route&&this.exit.trigger(this,this.state.previous,this.route,this.params),this.params=s,this.route=o,this.state.previous=t,this.enter.trigger(this,t,o,s),this.handler(e(o,s)))}return this},go:function(t,e,n){return this.state.push(this.get(t).generate(e),n),this},generate:function(t,e){return this.get(t).generate(e)}}),t.Route=t.Class.extend({init:function(e){return this.options=t.utils.merge({controller:function(){},format:"",match:/.*/,view:!1},e),this},query:function(t){var e=t.match(this.options.match);return null===e?!1:(e.shift(),e)},generate:function(t){var e=this.options.format;for(var n in t)e=e.replace(RegExp("\\:"+n,"g"),t[n]);return e}});var r,u=window.location.hash,a=!1;t.State=t.Class.extend({previous:!1,enabled:!1,init:function(e){return this.enabled=e.enabled||!1,this.options=t.utils.merge({scroll:!1}),this.states={},t.State.start(),this},get:function(){return this.enabled&&window.history.pushState?window.location.pathname.substring(1):window.location.hash.substring(1)},push:function(t,e,n){return this.enabled&&window.history.pushState?(window.history.pushState(e,n,t||"."),o()):i(t,this.options.scroll),this.states[t]=e,this},data:function(t){return t=t||this.get(),this.states[t]===void 0?null:this.states[t]}}),t.State.interval=500,t.State.start=function(){if(a)return t.State;var i="onhashchange"in window&&/MSIE\s(6|7)/.test(navigator.userAgent);return"onpopstate"in window?e("popstate"):i?(e("hashchange"),r=setInterval(function(){u!==window.location.hash&&(u=window.location.hash,n("hashchange"))},t.State.interval)):e("hashchange"),a=!0,t.State},t.State.stop=function(){r&&clearInterval(r);var t="onpopstate"in window?"popstate":"hashchange";return window.removeEventListener?window.removeEventListener(t,o):window[t]&&delete window[t],a=!1,State}}(),function(){t.View=t.Class.extend({init:function(e){return this.cache={},this.options=t.utils.merge({idPrefix:"vc-view-",idSuffix:"",idSeparator:"-",target:!1,http:{prefix:"views/",suffix:".html",headers:{Accept:"text/html"}}},e),this.http=this.options.http instanceof t.Http?this.options.http:new t.Http(this.options.http),this},render:function(t,e){var n=this,i=this.options.idPrefix+t.replace(/\//g,this.options.idSeparator)+this.options.idSuffix,o=function(){"function"==typeof e&&e.call(e,n,t)};return this.cache[t]?(this.renderer(this.cache[t]),o()):document.getElementById(i)?(this.renderer(this.cache[t]=document.getElementById(i).innerHTML),o()):this.http&&this.http.get({url:t,success:function(e){n.renderer(n.cache[t]=e),o()}}),this},renderer:function(t){var e=this.options.target;if(!e)throw"Cannot render view because no target was specified.";"string"==typeof e?e=document.getElementById(e):"function"==typeof e&&(e=e()),e.innerHTML=t}})}(),function(){t.values={},t.value=function(e,n){if("object"==typeof e?(n=e,e="default"):e||(e="default"),t.values[e]===void 0)throw'The value "'+e+'" is not registered as a Velcro Value.';return n=t.utils.merge(t.values[e].options,n),function(i){var o=!1,s=[],r=function(t){var e=r.get();return arguments.length?(e!==t&&(r.set(t),r.publish()),r.owner):e};return r.options=n,r.owner=i,r.value=null,r.init=function(){"function"==typeof t.values[e].init&&t.values[e].init.call(this),this.reset()},r.get=function(){return"function"==typeof t.values[e].get?t.values[e].get.call(this):null},r.set=function(n){return"function"==typeof t.values[e].set&&t.values[e].set.call(this,n),this},r.reset=function(){return this.options.value!==void 0?this.set(this.options.value):this.value===void 0&&(this.value=null),this},r.subscribe=function(t){return s.push(t),this},r.unsubscribe=function(t){for(var e=0;s.length>e;e++)if(t===subscriber)return s.splice(index,1),void 0;return this},r.publish=function(){for(var t=0;s.length>t;t++)s[t]();return this},r.updateEvery=function(t){var e=this;return o=setInterval(function(){e.publish()},t),this},r.stopUpdating=function(){return o&&clearInterval(o),this},r}},t.value.isWrapped=function(e){return"function"==typeof e&&""+e==""+t.value()},t.value.isUnwrapped=function(e){return"function"==typeof e&&""+e==""+t.value()()}}(),function(){t.values.array={init:function(){this.options.value=[]},get:function(){return this.value},set:function(e){this.value=t.utils.isArray(e)?e:[e]}}}(),function(){t.values.bool={options:{value:!1},get:function(){return this.value},set:function(t){this.value=t?!0:!1}}}(),function(){t.values.computed={options:{use:[],read:function(){},write:function(){}},init:function(){var t=this,e=this.options.use;for("function"==typeof e&&(e=e.call(this.owner)),"string"==typeof e&&(e=[e]),a=0;e.length>a;a++)"string"==typeof e[a]&&(e[a]=this.owner[e[a]]);for(b=0;e.length>b;b++)e[b].subscribe(function(){t.publish()})},get:function(){return this.options.read.call(this.owner)},set:function(t){this.options.write.call(this.owner,t)}}}(),function(){t.values.date={init:function(){this.value=new Date},get:function(){return ths.value},set:function(t){this.value=t instanceof Date?t:new Date(t)}}}(),function(){t.values["default"]={get:function(){return this.value},set:function(t){this.value=t}}}(),function(){t.values["float"]={options:{value:0},get:function(){return this.value},set:function(t){this.value=parseFloat(t)}}}(),function(){t.values["int"]={options:{value:0},get:function(){return this.value},set:function(t){this.value=parseInt(t)}}}(),function(){t.values.many={options:{model:t.Model},init:function(){this.value=new t.Collection(this.options.model),this.value._parent=this.owner},get:function(){return this.value},set:function(t){this.value.from(t)}}}(),function(){t.values.one={options:{model:t.Model},init:function(){this.value=new this.options.model,this.value._parent=this.owner},get:function(){return this.value},set:function(t){this.value.from(t)}}}(),function(){t.values.string={options:{value:""},get:function(){return this.value},set:function(t){this.value=""+t}}}(),function(){t.Model=t.Class.extend({_observer:t.value(),_parent:null,init:function(e){var n=[];this._observer=this._observer(this);for(var i in this)t.value.isWrapped(this[i])&&n.push(this[i]=this[i](this));for(var o=0;n.length>o;o++)n[o].init();"function"==typeof this.setup&&this.setup(),this.from(e)},parent:function(){return this._parent},clone:function(){return new this.constructor(this.to())},each:function(e){for(var n in this)t.value.isUnwrapped(this[n])&&e(n,this[n]);return this},from:function(e){return e?(e instanceof t.Model&&(e=e.to()),this.each(function(t,n){e[t]!==void 0&&n(e[t])}),this._observer.publish(),this):this},to:function(){var e={};return this.each(function(n,i){e[n]=i(),(e[n]instanceof t.Model||e[n]instanceof t.Collection)&&(e[n]=e[n].to())}),e},reset:function(){return this.each(function(t,e){e.reset()})}}),t.model=function(e){return t.Model.extend(e)},t.model.make=function(t){return new(this(t))}}(),function(){t.Collection=t.Class.extend({_observer:t.value(),_parent:null,_model:null,init:function(t,e){Array.prototype.push.apply(this,[]),this._observer=this._observer(this),this._model=t,this.from(e)},aggregate:function(e,n){var i=[];return n||(n=[e],e=""),this.each(function(o,s){var r=[];t.utils.each(n,function(t,e){"function"==typeof s[e]&&r.push(s[e]())}),i.push(r.join(e))}),i},at:function(t){return this[t]===void 0?!1:this[t]},first:function(){return this.at(0)},last:function(){return this.at(this.length-1)},has:function(t){return this[t]!==void 0},remove:function(t){return t="number"==typeof t?t:this.index(t),this.has(t)&&(Array.prototype.splice.call(this,t,1),this._observer.publish()),this},empty:function(){return Array.prototype.splice.call(this,0,this.length),this._observer.publish(),this},prepend:function(t){return this.insert(0,t)},append:function(t){return this.insert(this.length,t)},insert:function(e,n){return n=n instanceof t.Model?n:new this._model(n),n._parent=this._parent,Array.prototype.splice.call(this,e,0,n),this._observer.publish(),this},replace:function(e,n){return n=n instanceof t.Model?n:new this._model(n),n._parent=this._parent,Array.prototype.splice.call(this,e,1,n),this._observer.publish(),this},index:function(t){var e=-1;return this.each(function(n,i){return i===t?(e=n,void 0):void 0}),e},from:function(e){function n(t,e){e instanceof i._model||(e=new i._model(e),e._parent=i._parent),Array.prototype.splice.call(i,t,1,e)}var i=this;return e instanceof t.Collection?e.each(n):t.utils.each(e,n),this._observer.publish(),this},to:function(){var t=[];return this.each(function(e,n){t.push(n.to())}),t},each:function(t){for(var e=0;this.length>e;e++)t(e,this[e]);return this},find:function(e,n,i){var o=new t.Collection(this._model);return o._parent=this._parent,e instanceof t.Model&&(e=e.to()),"object"==typeof e&&(e=function(e){return function(){var n=this,i=!0;return t.utils.each(e,function(t,e){return n[t]===void 0||n[t]()!==e?(i=!1,!1):void 0}),i}}(e)),this.each(function(t,s){if(n&&i){var r=n*i-n;if(t>r)return}return e.call(s,t)&&o.append(s),n&&o.length===n?!1:void 0}),o},findOne:function(t){return this.find(t,1).first()},reset:function(){return this.each(function(t,e){e.reset()})}}),t.collection=function(e){return t.Collection.extend({init:function(n){t.Collection.prototype.init.call(this,e,n)}})},t.collection.make=function(t){return new(this(t))}}(),function(){t.modules={}}(),function(){t.bindings={}}(),function(){t.bindings.vcAttr=function(e,n){this.update=function(e){var i=t.dom(n);for(var o in e)i.attr(o,e[o])}}}(),function(){t.bindings.vcCheck=function(e,n){var i=!1,o=!1,s=t.dom(n);this.init=function(t,e){s.on("change",function(){o||(i=!0,n.checked?e.bind(!0):e.bind(!1),i=!1)})},this.update=function(t){i||(n.checked=t.bind?!0:!1,o=!0,s.fire("change"),o=!1)}}}(),function(){t.bindings.vcClick=function(e,n){this.init=function(e){t.dom(n).on("click",e.callback)}}}(),function(){t.bindings.vcContent=function(e,n){var i=t.dom(n);this.update=function(e){e.text!==void 0?i.text(e.text||""):e.html!==void 0?i.contents(e.html||""):t.utils.throwForElement(n,'The "content" binding must be given a "text" or "html" option.')}}}(),function(){t.bindings.vcCss=function(e,n){var n=t.dom(n),i=n.css();this.update=function(e){n.css(t.utils.merge(i,e))}}}(),function(){t.bindings.vcDisable=function(t,e){this.update=function(t){e.disabled=t.test?!0:!1}}}(),function(){t.bindings.vcEach=function(e,n){var i=e.context(),o=n.parentNode,s=[],r=t.dom(n).attr("vc-each",""),u=document.createComment("each placeholder"),a=r.html();n.parentNode.insertBefore(u,n),r.destroy(),this.options={as:"$data",key:"$index"},this.update=function(n){function r(r,c){var l=t.utils.merge(i,c),h=t.dom(a).raw();l[n.key]=r,l[n.as]=c,e.bind(h,l),s.push(h),o.insertBefore(h,u)}t.utils.each(s,function(e,n){t.dom(n).destroy()}),s=[],n.items instanceof t.Model?n.items.each(function(t,e){r(t,e())}):n.items instanceof t.Collection?n.items.each(r):t.utils.each(n.items,r)}}}(),function(){t.bindings.vcEnable=function(t,e){this.update=function(t){e.disabled=t.test?!1:!0}}}(),function(){t.bindings.vcExtend=function(e,n){var i=t.dom(n),o=i.contents();this.options={path:"",view:{}},this.update=function(i){var s=i.view instanceof t.View?i.view:new t.View(i.view),r=e.context();r.$content=o,s.options.target=n,s.render(i.path,function(){e.bindDescendants(n,r),delete r.$content})}}}(),function(){t.bindings.vcFocus=function(e,n){var i=!1,o=!1,s=!1,r=t.dom(n);this.init=function(t,e){r.on("focus",function(){s||(i=!0,e.bind(!0),i=!1)}).on("blur",function(){o||(i=!0,e.bind(!1),i=!1)})},this.update=function(t){i||(t.bind?(n.focus(),s=!0,r.fire("focus"),s=!1):(n.blur(),o=!0,r.fire("blur"),o=!1))}}}(),function(){t.bindings.vcHide=function(t,e){this.update=function(t){e.style.display=t.test?"none":null}}}(),function(){function e(e){return e instanceof t.Collection?e.length>0:e}t.bindings.vcIf=function(n,i){var o=i.parentNode,s=n.context(),r=t.dom(i).attr("vc-if",""),u=r.html(),a=document.createComment("if placeholder"),c=!1;o.insertBefore(a,i),r.destroy(),this.update=function(i){e(i.test)?(c=t.dom(u),o.insertBefore(c.raw(),a),n.bind(c.raw(),s)):c&&(c.destroy(),c=!1)}}}(),function(){function e(e){return e instanceof t.Collection?e.length>0:e}t.bindings.vcIfnot=function(n,i){var o=i.parentNode,s=n.context(),r=t.dom(i).attr("vc-ifnot",""),u=r.html(),a=document.createComment("ifnot placeholder"),c=!1;o.insertBefore(a,i),r.destroy(),this.update=function(i){e(i.test)?c&&(c.destroy(),c=!1):(c=t.dom(u),o.insertBefore(c.raw(),a),n.bind(c.raw(),s))}}}(),function(){t.bindings.vcInclude=function(e,n){this.options={path:"",context:!1,callback:function(){},view:{}},this.update=function(i){var o=i.view instanceof t.View?i.view:new t.View(i.view);o.options.target=n,"function"==typeof i.context&&(i.context=i.context()),i.path||t.utils.throwForElement(n,"A path option must be specified."),o.render(i.path,function(){e.bindDescendants(n,i.context),"function"==typeof i.callback&&i.callback()})}}}(),function(){t.bindings.vcOn=function(e,n){var i=t.dom(n);this.init=function(t){for(var e in t)i.on(e,t[e])}}}(),function(){function e(t){return t?"function"==typeof t?t():t:""}function n(e,n){return n?"function"==typeof n?n(e):e instanceof t.Model?e[n]():e:""}t.bindings.vcOptions=function(i,o){var s=t.dom(o);this.options={options:[],caption:"",text:"",update:null,value:""},this.init=function(t){"function"==typeof t.update&&s.on("change",function(){t.update(o.value)}),this.update(t)},this.update=function(i){function r(t,e){s.append('<option value="'+n(e,i.value)+'">'+n(e,i.text)+"</option>")}"select"!==s.tag()&&t.utils.throwForElement(o,"The options binding can only be bound to select list."),i.caption&&s.contents('<option value="">'+e(i.caption)+"</option>"),typeof i.options instanceof t.Collection?i.options.each(r):t.utils.each(i.options,r)}}}(),function(){t.bindings.vcRoutable=function(e,n){this.update=function(e){var i=e.router;i||t.utils.throwForElement(n,"Cannot bind router because it cannot be found."),!i instanceof t.Router&&t.utils.throwForElement(n,'Cannot bind router because it is not an instanceof "vc.Router".'),i.view.options.target=n,i.bind()}}}(),function(){t.bindings.vcShow=function(t,e){this.update=function(t){e.style.display=t.test?null:"none"}}}(),function(){t.bindings.vcStyle=function(t,e){this.update=function(t){for(var n in t)e.style[n]="function"==typeof t[n]?t[n]():t[n]}}}(),function(){t.bindings.vcSubmit=function(e,n){var i=t.dom(n);this.options={callback:function(){t.utils.throwForElement(n,'You must specify a callback to the "submit" binding.')}},this.init=function(t){i.on("submit",function(e){t.callback()!==!0&&(e.preventDefault(),e.stopPropagation())})}}}(),function(){t.bindings.vcValue=function(e,n){var i=!1,o=!1,s=t.dom(n);this.options={on:"change"},this.init=function(t,e){s.on(t.on,function(){o||(i=!0,e.value(n.value),i=!1)}),this.update(t,e)},this.update=function(t){i||(n.value=t.value,o=!0,s.fire(t.on),o=!1)}}}(),function(){t.bindings.vcWith=function(e,n){var i=n.innerHTML;n.innerHTML="",this.update=function(o){var s;"object"==typeof o.model?s=o.model:"function"==typeof o.controller?s=o.controller():t.utils.throwForElement(n,'You must either specify a model or controller to the "with" context.'),n.innerHTML=i,e.bindDescendants(n,s)}}}(),function(){function e(t){var e=!1,n=!0,i=window,o=i.document,s=o.documentElement,r=o.addEventListener?"addEventListener":"attachEvent",u=o.addEventListener?"removeEventListener":"detachEvent",a=o.addEventListener?"":"on";if(init=function(n){("readystatechange"!==n.type||"complete"===o.readyState)&&(("load"==n.type?i:o)[u](a+n.type,init,!1),!e&&(e=!0)&&t.call(i,n.type||n))},poll=function(){try{s.doScroll("left")}catch(t){return setTimeout(poll,50),void 0}init("poll")},"complete"==o.readyState)t.call(i,"lazy");else{if(o.createEventObject&&s.doScroll){try{n=!i.frameElement}catch(c){}n&&poll()}o[r](a+"DOMContentLoaded",init,!1),o[r](a+"readystatechange",init,!1),i[r](a+"load",init,!1)}}function n(t){if(t=t.toLowerCase(),-1===t.indexOf("-"))return t;for(var e=t.split("-"),n=1;e.length>n;n++)e[n]=e[n].charAt(0).toUpperCase()+e[n].substring(1);return e.join("")}t.App=t.Class.extend({init:function(){this.bound=[],this.contexts=[],currentModule=null,previousModule=null},context:function(t){return 0===arguments.length?(this.contexts.length||this.context({}),this.contexts[this.contexts.length-1]):(this.contexts.length?(t.$parent=this.contexts[this.contexts.length-1],t.$root=this.contexts[0]):(t.$parent=!1,t.$root=!1),this.contexts.push(t),this)},bind:function(t,e){return e&&this.context(e),this.bindOne(t),this.bindDescendants(t),e&&this.contexts.pop(),this},bindDescendants:function(e,n){var i=this;return t.utils.each(e.childNodes,function(t,e){i.bind(e,n)}),this},bindOne:function(t){if(-1!==this.bound.indexOf(t))return this;this.bound.push(t);var e=this.getModuleForElement(t);return e?this.applyModule(t,e):this.applyBindings(t),this},applyModule:function(e,i){function o(t){s.bind(h.replaceWith(t).raw(),r)}var s=this,r=this.context(),u=n(e.nodeName),a=i.parents;this.previousModule=this.currentModule,this.currentModule=u,"function"==typeof a&&(a=a()),"string"==typeof a&&(a=[a]),a&&a.indexOf(this.previousModule)&&t.utils.throwForElement(e,'The module "'+this.currentModule+'" must not be a child of "'+this.previousModule+'". Valid parents are "'+a.join(", ")+'".');var c=t.dom(e),l=c.contents(),h=c.replaceWith("<!-- module -->");"string"==typeof i.template?l=i.template:"function"==typeof i.template&&(l=i.template(l,o)),"function"==typeof i.controller&&(r=i.controller(r)),l&&o(l),this.currentModule=this.previousModule},applyBindings:function(t){var e=this.getBindingsForElement(t);for(var n in e)this.applyBinding(t,n,e[n],this.context());return this},applyBinding:function(e,n,i,o){function s(){var e=r.parseBinding(i,o);a.update(t.utils.merge(a.options,e.options),e.bound)}var r=this,u=this.parseBinding(i,o);"function"!=typeof t.bindings[n]&&t.utils.throwForElement(e,'The binding "'+n+'" must be a constructor.');var a=new t.bindings[n](this,e);if("function"==typeof a.init?a.init(t.utils.merge(a.options,u.options),u.bound):"function"==typeof a.update&&a.update(t.utils.merge(a.options,u.options),u.bound),"function"==typeof a.update)for(var c in u.bound)u.bound[c].subscribe(s);return this},parseBinding:function(e,n){var i=t.utils.parseBinding(e,n),o={options:{},bound:{}};for(var s in i)t.value.isUnwrapped(i[s])?(o.options[s]=i[s](),o.bound[s]=o.options[s]instanceof t.Model||o.options[s]instanceof t.Collection?o.options[s]._observer:i[s]):o.options[s]="function"==typeof i[s]?i[s].bind(n):i[s];return o},getModuleForElement:function(e){var i=n(e.nodeName);return"function"==typeof t.modules[i]?new t.modules[i](this):void 0},getBindingsForElement:function(e){var i={};if(e.attributes)for(var o=0;e.attributes.length>o;o++){var s=e.attributes[o],r=n(s.nodeName),u=s.nodeValue;"function"==typeof t.bindings[r]&&(i[r]=u)}return i}}),t.app=function(n,i){var o=new t.App;return e(function(){o.bind(t.dom(n).raw()||document,i||window)}),o}}(),"object"==typeof window.velcro){var e=t.utils.merge({autorun:!0},window.velcro);e.autorun&&t.app()}});